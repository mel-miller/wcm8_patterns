{"version":3,"sources":["03-organisms/tab-group/tab-group.js"],"names":["behaviors","tabs","attach","document","querySelectorAll","addEventListener","index","target","keyCode","end","preventDefault","length","home","up","down","left","right","delete","getAttribute","x","focus","removeAttribute","setAttribute","getElementById","removeEventListener","parentElement","removeChild","setTimeout","focused","activeElement","hasAttribute","Drupal"],"mappings":"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","file":"tab-group.js","sourcesContent":["(function (Drupal) {\n\n  Drupal.behaviors.tabs = {\n    attach: function(context, settings) {\n\n      'use strict';\n\n      var tablist = document.querySelectorAll('[role=\"tablist\"]')[0];\n      var tabs;\n      var panels;\n      var delay = determineDelay();\n\n      generateArrays();\n\n      function generateArrays() {\n        tabs = document.querySelectorAll('[role=\"tab\"]');\n        panels = document.querySelectorAll('[role=\"tabpanel\"]');\n      };\n\n      // For easy reference\n      var keys = {\n        end: 35,\n        home: 36,\n        left: 37,\n        up: 38,\n        right: 39,\n        down: 40,\n        delete: 46\n      };\n\n      // Add or substract depenign on key pressed\n      var direction = {\n        37: -1,\n        38: -1,\n        39: 1,\n        40: 1\n      };\n\n      // Bind listeners\n      var i;\n      for (i = 0; i < tabs.length; ++i) {\n        addListeners(i);\n      };\n\n      function addListeners(index) {\n        tabs[index].addEventListener('click', clickEventListener);\n        tabs[index].addEventListener('keydown', keydownEventListener);\n        tabs[index].addEventListener('keyup', keyupEventListener);\n\n        // Build an array with all tabs (<button>s) in it\n        tabs[index].index = index;\n      };\n\n      // When a tab is clicked, activateTab is fired to activate it\n      function clickEventListener(event) {\n        var tab = event.target;\n        activateTab(tab, false);\n      };\n\n      // Handle keydown on tabs\n      function keydownEventListener(event) {\n        var key = event.keyCode;\n\n        switch (key) {\n          case keys.end:\n            event.preventDefault();\n            // Activate last tab\n            activateTab(tabs[tabs.length - 1]);\n            break;\n          case keys.home:\n            event.preventDefault();\n            // Activate first tab\n            activateTab(tabs[0]);\n            break;\n\n            // Up and down are in keydown\n            // because we need to prevent page scroll >:)\n          case keys.up:\n          case keys.down:\n            determineOrientation(event);\n            break;\n        };\n      };\n\n      // Handle keyup on tabs\n      function keyupEventListener(event) {\n        var key = event.keyCode;\n\n        switch (key) {\n          case keys.left:\n          case keys.right:\n            determineOrientation(event);\n            break;\n          case keys.delete:\n            determineDeletable(event);\n            break;\n        };\n      };\n\n      // When a tablistâ€™s aria-orientation is set to vertical,\n      // only up and down arrow should function.\n      // In all other cases only left and right arrow function.\n      function determineOrientation(event) {\n        var key = event.keyCode;\n        var vertical = tablist.getAttribute('aria-orientation') == 'vertical';\n        var proceed = false;\n\n        if (vertical) {\n          if (key === keys.up || key === keys.down) {\n            event.preventDefault();\n            proceed = true;\n          };\n        } else {\n          if (key === keys.left || key === keys.right) {\n            proceed = true;\n          };\n        };\n\n        if (proceed) {\n          switchTabOnArrowPress(event);\n        };\n      };\n\n      // Either focus the next, previous, first, or last tab\n      // depening on key pressed\n      function switchTabOnArrowPress(event) {\n        var pressed = event.keyCode;\n\n        for (x = 0; x < tabs.length; x++) {\n          tabs[x].addEventListener('focus', focusEventHandler);\n        };\n\n        if (direction[pressed]) {\n          var target = event.target;\n          if (target.index !== undefined) {\n            if (tabs[target.index + direction[pressed]]) {\n              tabs[target.index + direction[pressed]].focus();\n            } else if (pressed === keys.left || pressed === keys.up) {\n              focusLastTab();\n            } else if (pressed === keys.right || pressed == keys.down) {\n              focusFirstTab();\n            };\n          };\n        };\n      };\n\n      // Activates any given tab panel\n      function activateTab(tab, setFocus) {\n        setFocus = setFocus || true;\n        // Deactivate all other tabs\n        deactivateTabs();\n\n        // Remove tabindex attribute\n        tab.removeAttribute('tabindex');\n\n        // Set the tab as selected\n        tab.setAttribute('aria-selected', 'true');\n\n        // Get the value of aria-controls (which is an ID)\n        var controls = tab.getAttribute('aria-controls');\n\n        // Remove hidden attribute from tab panel to make it visible\n        document.getElementById(controls).removeAttribute('hidden');\n\n        // Set focus when required\n        if (setFocus) {\n          tab.focus();\n        };\n      };\n\n      // Deactivate all tabs and tab panels\n      var t;\n      var p;\n      function deactivateTabs() {\n        for (t = 0; t < tabs.length; t++) {\n          tabs[t].setAttribute('tabindex', '-1');\n          tabs[t].setAttribute('aria-selected', 'false');\n          tabs[t].removeEventListener('focus', focusEventHandler);\n        };\n\n        for (p = 0; p < panels.length; p++) {\n          panels[p].setAttribute('hidden', 'hidden');\n        };\n      };\n\n      // Make a guess\n      function focusFirstTab() {\n        tabs[0].focus();\n      };\n\n      // Make a guess\n      function focusLastTab() {\n        tabs[tabs.length - 1].focus();\n      };\n\n      // Detect if a tab is deletable\n      function determineDeletable(event) {\n        target = event.target;\n\n        if (target.getAttribute('data-deletable') !== null) {\n          // Delete target tab\n          deleteTab(event, target);\n\n          // Update arrays related to tabs widget\n          generateArrays();\n\n          // Activate the closest tab to the one that was just deleted\n          if (target.index - 1 < 0) {\n            activateTab(tabs[0]);\n          } else {\n            activateTab(tabs[target.index - 1]);\n          };\n        };\n      };\n\n      // Deletes a tab and its panel\n      function deleteTab(event) {\n        var target = event.target;\n        var panel = document.getElementById(target.getAttribute('aria-controls'));\n\n        target.parentElement.removeChild(target);\n        panel.parentElement.removeChild(panel);\n      };\n\n      // Determine whether there should be a delay\n      // when user navigates with the arrow keys\n      function determineDelay() {\n        var hasDelay = tablist.hasAttribute('data-delay');\n        var delay = 0;\n\n        if (hasDelay) {\n          var delayValue = tablist.getAttribute('data-delay');\n          if (delayValue) {\n            delay = delayValue;\n          } else {\n            // If no value is specified, default to 300ms\n            delay = 300;\n          };\n        };\n\n        return delay;\n      };\n\n      //\n      function focusEventHandler(event) {\n        var target = event.target;\n\n        setTimeout(checkTabFocus, delay, target);\n      };\n\n      // Only activate tab on focus if it still has focus after the delay\n      function checkTabFocus(target) {\n        focused = document.activeElement;\n\n        if (target === focused) {\n          activateTab(target, false);\n        };\n      };\n\n    }\n  }\n\n})(Drupal);\n"]}