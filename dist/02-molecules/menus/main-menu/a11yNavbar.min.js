'use strict';function _extends(){return _extends=Object.assign||function(e){for(var a,b=1;b<arguments.length;b++)for(var c in a=arguments[b],a)Object.prototype.hasOwnProperty.call(a,c)&&(e[c]=a[c]);return e},_extends.apply(this,arguments)}function _classCallCheck(c,a){if(!(c instanceof a))throw new TypeError('Cannot call a class as a function')}function _defineProperties(e,a){for(var b,c=0;c<a.length;c++)b=a[c],b.enumerable=b.enumerable||!1,b.configurable=!0,'value'in b&&(b.writable=!0),Object.defineProperty(e,b.key,b)}function _createClass(d,a,b){return a&&_defineProperties(d.prototype,a),b&&_defineProperties(d,b),d}var a11yNavbar=function(){function i(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,i),this._keyCode={TAB:9,ENTER:13,ESC:27,SPACE:32,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40},this._touchmoveActive=!1,this._defaultOptions={windowObj:window,domObj:document,ariaLabel:'',hoverintent:hoverintent,orientation:'horizontal',breakpointMinWidth:500,responsiveToggleText:'Menu',mode:'standard'},this._options=_extends(this._defaultOptions,b),this._id=a,this._navElem=this._options.domObj.getElementById(this._id),this._menubarMenuitems=[],this._currentMenubarIndex=0,this._currentMenuitem=null,this._navElem.addEventListener('focusout',this.handleFocusoutNavElem.bind(this)),'dualAction'==this._options.mode&&(this._menubarInstructions=this._options.domObj.createElement('div'),this._menubarInstructions.innerHTML='<p>Use <strong>Enter</strong> or <strong>Space</strong> to activate links.</p><p>Use appropriate arrow key to open or close submenus.</p>',this._menubarInstructions.setAttribute('id',this._id+'-menubar-instructions'),this._menubarInstructions.classList.add('a11y-navbar-instructions'),this._navElem.insertBefore(this._menubarInstructions,this._navElem.firstElementChild)),this._menubarToggle=this._options.domObj.createElement('button'),this._menubarToggle.textContent=this._options.responsiveToggleText,this._menubarToggle.setAttribute('id',this._id+'-toggle'),this._menubarToggle.setAttribute('aria-expanded','false'),this._menubarToggle.setAttribute('aria-controls',this._id),this._menubarToggle.classList.add('a11y-navbar-toggle');var c=this._options.domObj.createElement('span');c.setAttribute('aria-hidden','true'),this._menubarToggle.appendChild(c),this._menubarToggle.addEventListener('click',this.handleClickMenubarToggle.bind(this)),this._options.windowObj.addEventListener('resize',this.handleMenubarResize.bind(this)),this._navElem.setAttribute('aria-label',this._options.ariaLabel),this._navElem.classList.add('a11y-navbar');var d=this._navElem.querySelector('ul');(d.setAttribute('aria-label',this._options.ariaLabel),d.classList.add('a11y-navbar-menubar'),d.classList.add('a11y-navbar-orientation-'+this._options.orientation),'horizontal'==this._options.orientation?d.setAttribute('role','menubar'):'vertical'==this._options.orientation&&d.setAttribute('role','menu'),this._options.hoverintent)?this._options.hoverintent(d,function(){},this.handleMouseoutMenubar.bind(this)).options({timeout:900,interval:50}):d.addEventListener('mouseout',this.handleMouseoutMenubar.bind(this));for(var e,f=d.children,g=0;g<f.length;g++)e=f[g].firstElementChild,e.classList.add('a11y-navbar-menuitem'),this._menubarMenuitems[g]=e,e.addEventListener('keydown',this.handleKeydownMenubar.bind(this));for(var h=this._navElem.querySelectorAll('a + ul > li > a'),j=0;j<h.length;j++)h[j].addEventListener('keydown',this.handleKeydownSubmenu.bind(this)),h[j].addEventListener('focusin',this.handleFocusinMenuitem.bind(this));for(var k=d.querySelectorAll('li > a'),l=0;l<k.length;l++){k[l].setAttribute('role','menuitem'),k[l].setAttribute('tabindex','-1');for(var m=k[l].parentNode,n=m.querySelectorAll('a + ul'),o=0;o<n.length;o++){var p=n[o].parentNode,q=p.querySelector('a'),r=q.textContent;q.setAttribute('aria-haspopup','true'),q.setAttribute('aria-expanded','false'),n[o].setAttribute('role','menu'),n[o].setAttribute('aria-label',r),n[o].classList.add('a11y-navbar-menu-closed')}this._options.hoverintent?this._options.hoverintent(k[l],this.handleMouseoverMenuitem.bind(this),function(){}).options({timeout:500,interval:100}):k[l].addEventListener('mouseover',this.handleMouseoverMenuitem.bind(this)),k[l].addEventListener('click',this.handleClickMenuitem.bind(this)),k[l].addEventListener('touchstart',this.handleTouchstartMenuitem.bind(this)),k[l].addEventListener('touchmove',this.handleTouchmoveMenuitem.bind(this)),k[l].addEventListener('touchend',this.handleTouchendMenuitem.bind(this))}for(var s=d.querySelectorAll('li'),t=0;t<s.length;t++)s[t].setAttribute('role','none');this._menubarMenuitems[0].setAttribute('tabindex','0'),'dualAction'==this._options.mode&&this._menubarMenuitems[0].setAttribute('aria-describedby',this._id+'-menubar-instructions'),this._currentMenuitem=this._menubarMenuitems[0],this.menubarResize()}return _createClass(i,[{key:'destroy',value:function(){}},{key:'handleMenubarResize',value:function(b){b.defaultPrevented||this.menubarResize()}},{key:'handleClickMenubarToggle',value:function(b){b.defaultPrevented||(this._navElem.classList.contains('a11y-navbar-closed')?(this._navElem.classList.remove('a11y-navbar-closed'),this._navElem.classList.add('a11y-navbar-open'),this._menubarToggle.setAttribute('aria-expanded','true')):this._navElem.classList.contains('a11y-navbar-open')&&(this._navElem.classList.remove('a11y-navbar-open'),this._navElem.classList.add('a11y-navbar-closed'),this._menubarToggle.setAttribute('aria-expanded','false')))}},{key:'handleKeydownMenubar',value:function(j){if(!j.defaultPrevented){var a=!1,b=j.target,c=this.normalizeKey(j.key||j.keyCode),d=this._options.mode;if(c==this._keyCode.SPACE&&'standard'==d||c==this._keyCode.ENTER&&'standard'==d||'horizontal'==this._options.orientation&&c==this._keyCode.ARROW_DOWN||'vertical'==this._options.orientation&&c==this._keyCode.ARROW_RIGHT){this.closeAllSubmenus(),this.openSubmenu(b);var e=b.parentNode.querySelector('ul[role=menu] > li').firstElementChild;null!=e&&(e.focus(),this.updateCurrentMenuitem(e)),a=!0}else if(c==this._keyCode.SPACE&&'dualAction'==d||c==this._keyCode.ENTER&&'dualAction'==d)this.performClick(b),a=!0;else if('horizontal'==this._options.orientation&&c==this._keyCode.ARROW_RIGHT||'vertical'==this._options.orientation&&c==this._keyCode.ARROW_DOWN){var k=this._currentMenubarIndex+1>=this._menubarMenuitems.length?0:this._currentMenubarIndex+1,f=this._menubarMenuitems[k];f.focus(),this._currentMenubarIndex=k,this.updateCurrentMenuitem(f),a=!0}else if('horizontal'==this._options.orientation&&c==this._keyCode.ARROW_LEFT||'vertical'==this._options.orientation&&c==this._keyCode.ARROW_UP){var g=0>this._currentMenubarIndex-1?this._menubarMenuitems.length-1:this._currentMenubarIndex-1,h=this._menubarMenuitems[g];h.focus(),this._currentMenubarIndex=g,this.updateCurrentMenuitem(h),a=!0}else if('horizontal'==this._options.orientation&&c==this._keyCode.ARROW_UP||'vertical'==this._options.orientation&&c==this._keyCode.ARROW_LEFT){if(this.hasSubmenu(b)){this.closeAllSubmenus(),this.openSubmenu(b);var i=b.parentNode.querySelector('ul[role=menu]').lastElementChild.firstElementChild;i.focus(),this.updateCurrentMenuitem(i)}a=!0}else if(c==this._keyCode.HOME){var l=this._menubarMenuitems[0];l.focus(),this.updateCurrentMenuitem(l),a=!0}else if(c==this._keyCode.END){var m=this._menubarMenuitems[this._menubarMenuitems.length-1];m.focus(),this.updateCurrentMenuitem(m),a=!0}else;a&&(j.stopPropagation(),j.preventDefault())}}},{key:'handleKeydownSubmenu',value:function(n){if(!n.defaultPrevented){var a=!1,b=n.target,c=this.normalizeKey(n.key||n.keyCode),d=this._options.mode;if((c==this._keyCode.SPACE||c==this._keyCode.ENTER)&&'standard'==d){if(this.hasSubmenu(b)){this.openSubmenu(b);var e=b.parentNode.querySelector('ul[role=menu] > li').firstElementChild;null!=e&&(e.focus(),this.updateCurrentMenuitem(e)),a=!0}else this.performClick(b),a=!0;}else if((c==this._keyCode.SPACE||c==this._keyCode.ENTER)&&'dualAction'==d)this.performClick(b),a=!0;else if(c==this._keyCode.ESC){var o=b.parentNode.parentNode.parentNode.querySelector('a[role=menuitem]');this.closeSubmenu(o),o.focus(),this.updateCurrentMenuitem(o),a=!0}else if(c==this._keyCode.ARROW_RIGHT){if(this.hasSubmenu(b)){var p=b.parentNode.querySelector('a + ul').querySelector('li > a');this.openSubmenu(b),p.focus(),this.updateCurrentMenuitem(p)}else{this.closeAllSubmenus();var q=this._currentMenubarIndex+1>=this._menubarMenuitems.length?0:this._currentMenubarIndex+1,f=this._menubarMenuitems[q];f.focus(),this.openSubmenu(f),this._currentMenubarIndex=q,this.updateCurrentMenuitem(f)}a=!0}else if(c==this._keyCode.ARROW_LEFT){var g=b.parentNode.parentNode.parentNode.querySelector('a[role=menuitem]');if(this.closeSubmenu(g),g.focus(),this.updateCurrentMenuitem(g),this._currentMenuitem.classList.contains('a11y-navbar-menuitem')){var r=0>this._currentMenubarIndex-1?this._menubarMenuitems.length-1:this._currentMenubarIndex-1,h=this._menubarMenuitems[r];h.focus(),this.openSubmenu(h),this._currentMenubarIndex=r,this.updateCurrentMenuitem(h)}a=!0}else if(c==this._keyCode.ARROW_DOWN){var i,j=b.parentNode.nextElementSibling;i=null==j?b.parentNode.parentNode.firstElementChild.querySelector('a'):j.querySelector('a'),i.focus(),this.updateCurrentMenuitem(i),a=!0}else if(c==this._keyCode.ARROW_UP){var k,l=b.parentNode.previousElementSibling;k=null==l?b.parentNode.parentNode.lastElementChild.querySelector('a'):l.querySelector('a'),k.focus(),this.updateCurrentMenuitem(k),a=!0}else if(c==this._keyCode.HOME){var m=b.parentNode.parentNode.firstElementChild.querySelector('a');m.focus(),this.updateCurrentMenuitem(m),a=!0}else if(c==this._keyCode.END){var s=b.parentNode.parentNode.lastElementChild.querySelector('a');s.focus(),this.updateCurrentMenuitem(s),a=!0}else;a&&(n.stopPropagation(),n.preventDefault())}}},{key:'handleMouseoverMenuitem',value:function(c){if(!c.defaultPrevented){var a=c.target;this.hasSubmenu(a)&&this.openSubmenu(a),this.closeSiblingSubmenus(a)}}},{key:'handleMouseoutMenubar',value:function(b){b.defaultPrevented||(b.target,this.closeAllSubmenus())}},{key:'handleClickMenuitem',value:function(c){if(!c.defaultPrevented){c.preventDefault();var a=c.target;this.clickMenuitem(a)}}},{key:'handleTouchstartMenuitem',value:function(b){b.defaultPrevented}},{key:'handleTouchmoveMenuitem',value:function(b){b.defaultPrevented||(this._touchmoveActive=!0)}},{key:'handleTouchendMenuitem',value:function(b){if(!b.defaultPrevented)if(b.preventDefault(),this._touchmoveActive)this._touchmoveActive=!1;else{var a=b.target;this.clickMenuitem(a)}}},{key:'handleFocusinMenuitem',value:function(c){var a=c.target;this.openParentSubmenus(a)}},{key:'handleFocusoutNavElem',value:function(c){var a=c.relatedTarget;null!=a&&this._navElem.contains(a)||(this.updateCurrentMenuitem(this._menubarMenuitems[0]),this._currentMenubarIndex=0,this.closeAllSubmenus())}},{key:'menubarResize',value:function(){var b=this._options.windowObj.innerWidth;b<=this._options.breakpointMinWidth?this.addMenubarToggle():this.removeMenubarToggle()}},{key:'addMenubarToggle',value:function(){null==this._options.domObj.getElementById(this._menubarToggle.getAttribute('id'))&&(this._navElem.parentNode.insertBefore(this._menubarToggle,this._navElem),this._navElem.classList.add('a11y-navbar-responsive'),this._navElem.classList.add('a11y-navbar-closed'),this._menubarToggle.setAttribute('aria-expanded','false'))}},{key:'removeMenubarToggle',value:function(){this._options.domObj.getElementById(this._menubarToggle.getAttribute('id'))&&(this._navElem.parentNode.removeChild(this._menubarToggle),this._navElem.classList.remove('a11y-navbar-responsive'),this._navElem.classList.remove('a11y-navbar-open'),this._navElem.classList.remove('a11y-navbar-closed'),this._menubarToggle.setAttribute('aria-expanded','false'))}},{key:'showMenubar',value:function(){this._navElem.classList.remove('a11y-navbar-closed'),this._navElem.classList.add('a11y-navbar-open')}},{key:'hideMenubar',value:function(){this._navElem.classList.remove('a11y-navbar-open'),this._navElem.classList.add('a11y-navbar-closed')}},{key:'toggleInstructions',value:function(){var b=!!this._menubarInstructions.classList.contains('a11y-navbar-instructions-show');b?this.hideInstructions():this.showInstructions()}},{key:'showInstructions',value:function(){this._menubarInstructions.classList.add('a11y-navbar-instructions-show'),this._menubarInstructions.classList.remove('a11y-navbar-instructions-hide')}},{key:'hideInstructions',value:function(){this._menubarInstructions.classList.add('a11y-navbar-instructions-hide'),this._menubarInstructions.classList.remove('a11y-navbar-instructions-show')}},{key:'updateCurrentMenuitem',value:function(b){this._currentMenuitem.setAttribute('tabindex','-1'),this._currentMenuitem=b,this._currentMenuitem.setAttribute('tabindex','0')}},{key:'hasSubmenu',value:function(d){var a=d.parentNode,b=a.querySelector('a + ul');return null!=b}},{key:'openSubmenu',value:function(d){var a=d.parentNode,b=a.querySelector('ul');null!=b&&(b.classList.remove('a11y-navbar-menu-closed'),b.classList.add('a11y-navbar-menu-open'),d.setAttribute('aria-expanded','true'))}},{key:'openParentSubmenus',value:function(c){var a=c.parentNode.parentNode;if(a.classList.contains('a11y-navbar-menu-closed')){var b=a.parentNode.querySelector('a[aria-expanded="false"]');null!=b&&(this.openSubmenu(b),this.openParentSubmenus(b))}}},{key:'closeSubmenu',value:function(d){var a=d.parentNode,b=a.querySelector('ul');null!=b&&(b.classList.remove('a11y-navbar-menu-open'),b.classList.add('a11y-navbar-menu-closed'),d.setAttribute('aria-expanded','false'))}},{key:'closeSiblingSubmenus',value:function(f){for(var a=f.parentNode.parentNode,b=a.querySelectorAll('li > a[role=menuitem]'),c=[],d=0;d<b.length;d++)b[d]!==f&&c.push(b[d]);for(var e=0;e<c.length;e++)this.closeSubmenu(c[e])}},{key:'closeAllSubmenus',value:function(){for(var d,a=this._navElem.querySelectorAll('ul.a11y-navbar-menu-open'),b=0;b<a.length;b++)d=a[b].parentNode.querySelector('a'),d.setAttribute('aria-expanded','false'),a[b].classList.remove('a11y-navbar-menu-open'),a[b].classList.add('a11y-navbar-menu-closed')}},{key:'performClick',value:function(c){var a=c.getAttribute('href');window.location=a}},{key:'clickMenuitem',value:function(c){var a=c.hasAttribute('aria-expanded');if(a){var b=c.getAttribute('aria-expanded');'true'==b?this.performClick(c):this.openSubmenu(c)}else this.performClick(c)}},{key:'normalizeKey',value:function(c){var a=null;switch(c){case'Tab':case 9:a=this._keyCode.TAB;break;case'Enter':case 13:a=this._keyCode.ENTER;break;case'Escape':case'Esc':case 13:a=this._keyCode.ESC;break;case' ':case 32:a=this._keyCode.SPACE;break;case'End':case 35:a=this._keyCode.END;case'Home':case 36:a=this._keyCode.HOME;break;case'ArrowLeft':case 37:a=this._keyCode.ARROW_LEFT;break;case'ArrowUp':case 38:a=this._keyCode.ARROW_UP;break;case'ArrowRight':case 39:a=this._keyCode.ARROW_RIGHT;break;case'ArrowDown':case 40:a=this._keyCode.ARROW_DOWN;}return a}}]),i}();
//# sourceMappingURL=a11yNavbar.min.js.map
