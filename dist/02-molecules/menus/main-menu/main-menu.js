'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}var a11yMenubar=function(){function a(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:document,d=2<arguments.length&&void 0!==arguments[2]?arguments[2]:'',e=3<arguments.length&&void 0!==arguments[3]?arguments[3]:e;_classCallCheck(this,a),this._keyCode={TAB:9,ENTER:13,ESC:27,SPACE:32,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40},this._id=b,this._domObj=c,this._hoverintent=e,this._ariaLabel=d,this._navElem=this._domObj.getElementById(this._id),this._menubarMenuitems=[],this._currentMenubarIndex=0,this._currentMenuitem=null,this._navElem.setAttribute('aria-label',this._ariaLabel),this._navElem.classList.add('a11y-menubar');var f=this._navElem.querySelector('ul');if(f.setAttribute('role','menubar'),f.setAttribute('aria-label',this._ariaLabel),this._hoverintent){this._hoverintent(f,function(){},this.handleMouseoutMenubar.bind(this)).options({timeout:900,interval:50})}else f.addEventListener('mouseout',this.handleMouseoutMenubar.bind(this));for(var g,h=f.children,m=0;m<h.length;m++)g=h[m].firstChild,g.classList.add('a11y-menubar-menuitem'),this._menubarMenuitems[m]=g,g.addEventListener('keydown',this.handleKeydownMenubar.bind(this));for(var i=this._navElem.querySelectorAll('a + ul > li > a'),n=0;n<i.length;n++)i[n].addEventListener('keydown',this.handleKeydownSubmenu.bind(this));for(var o=f.querySelectorAll('li > a'),p=0;p<o.length;p++){o[p].setAttribute('role','menuitem'),o[p].setAttribute('tabindex','-1');for(var j=o[p].parentNode,q=j.querySelectorAll('a + ul'),r=0;r<q.length;r++){var k=q[r].parentNode,s=k.querySelector('a'),t=s.textContent;s.setAttribute('aria-haspopup','true'),s.setAttribute('aria-expanded','false'),q[r].setAttribute('role','menu'),q[r].setAttribute('aria-label',t),q[r].classList.add('a11y-menubar-menu-closed')}if(this._hoverintent){this._hoverintent(o[p],this.handleMouseoverMenuitem.bind(this),function(){}).options({timeout:100,interval:0})}else o[p].addEventListener('mouseover',this.handleMouseoverMenuitem.bind(this))}for(var u=f.querySelectorAll('li'),v=0;v<u.length;v++)u[v].setAttribute('role','none');this._menubarMenuitems[0].setAttribute('tabindex','0'),this._currentMenuitem=this._menubarMenuitems[0]}return _createClass(a,[{key:'destroy',value:function destroy(){}},{key:'handleKeydownMenubar',value:function handleKeydownMenubar(a){if(!a.defaultPrevented){var b=!1,c=a.target,d=this.normalizeKey(a.key||a.keyCode);if(d==this._keyCode.SPACE||d==this._keyCode.ENTER||d==this._keyCode.ARROW_DOWN){this.closeAllSubmenus(),this.openSubmenu(c);var i=c.parentNode.querySelector('ul[role=menu] > li > a[role=menuitem]');null!=i&&(i.focus(),this.updateCurrentMenuitem(i)),b=!0}else if(d==this._keyCode.ARROW_RIGHT){var e=this._currentMenubarIndex+1>=this._menubarMenuitems.length?0:this._currentMenubarIndex+1,f=this._menubarMenuitems[e];f.focus(),this._currentMenubarIndex=e,this.updateCurrentMenuitem(f),b=!0}else if(d==this._keyCode.ARROW_LEFT){var g=0>this._currentMenubarIndex-1?this._menubarMenuitems.length-1:this._currentMenubarIndex-1,h=this._menubarMenuitems[g];h.focus(),this._currentMenubarIndex=g,this.updateCurrentMenuitem(h),b=!0}else if(d==this._keyCode.ARROW_UP){this.openSubmenu(c);var j=c.parentNode.querySelector('ul[role=menu]').lastElementChild.firstElementChild;j.focus(),this.updateCurrentMenuitem(j),b=!0}else if(d==this._keyCode.HOME){var k=this._menubarMenuitems[0];k.focus(),this.updateCurrentMenuitem(k),b=!0}else if(d==this._keyCode.END){var l=this._menubarMenuitems[this._menubarMenuitems.length-1];l.focus(),this.updateCurrentMenuitem(l),b=!0}else;b&&(a.stopPropagation(),a.preventDefault())}}},{key:'handleKeydownSubmenu',value:function handleKeydownSubmenu(a){if(!a.defaultPrevented){var b=!1,c=a.target,d=this.normalizeKey(a.key||a.keyCode);if(d==this._keyCode.SPACE||d==this._keyCode.ENTER)c.click(),b=!0;else if(d==this._keyCode.ESC){var m=c.parentNode.parentNode.parentNode.querySelector('a[role=menuitem]');this.closeSubmenu(m),m.focus(),this.updateCurrentMenuitem(m),b=!0}else if(d==this._keyCode.ARROW_RIGHT){if(this.hasSubmenu(c)){var n=c.parentNode.querySelector('a + ul').querySelector('li > a');this.openSubmenu(c),n.focus(),this.updateCurrentMenuitem(n)}else{this.closeAllSubmenus();var e=this._currentMenubarIndex+1>=this._menubarMenuitems.length?0:this._currentMenubarIndex+1,f=this._menubarMenuitems[e];f.focus(),this.openSubmenu(f),this._currentMenubarIndex=e,this.updateCurrentMenuitem(f)}b=!0}else if(d==this._keyCode.ARROW_LEFT){var o=c.parentNode.parentNode.parentNode.querySelector('a[role=menuitem]');if(this.closeSubmenu(o),o.focus(),this.updateCurrentMenuitem(o),this._currentMenuitem.classList.contains('a11y-menubar-menuitem')){var g=0>this._currentMenubarIndex-1?this._menubarMenuitems.length-1:this._currentMenubarIndex-1,h=this._menubarMenuitems[g];h.focus(),this.openSubmenu(h),this._currentMenubarIndex=g,this.updateCurrentMenuitem(h)}b=!0}else if(d==this._keyCode.ARROW_DOWN){var i=void 0,j=c.parentNode.nextElementSibling;i=null==j?c.parentNode.parentNode.firstElementChild.querySelector('a'):j.querySelector('a'),i.focus(),this.updateCurrentMenuitem(i),b=!0}else if(d==this._keyCode.ARROW_UP){var k=void 0,l=c.parentNode.previousElementSibling;k=null==l?c.parentNode.parentNode.lastElementChild.querySelector('a'):l.querySelector('a'),k.focus(),this.updateCurrentMenuitem(k),b=!0}else if(d==this._keyCode.HOME){var p=c.parentNode.parentNode.firstElementChild.querySelector('a');p.focus(),this.updateCurrentMenuitem(p),b=!0}else if(d==this._keyCode.END){var q=c.parentNode.parentNode.lastElementChild.querySelector('a');q.focus(),this.updateCurrentMenuitem(q),b=!0}else;b&&(a.stopPropagation(),a.preventDefault())}}},{key:'handleMouseoverMenuitem',value:function handleMouseoverMenuitem(a){if(!a.defaultPrevented){var b=a.target;this.hasSubmenu(b)&&this.openSubmenu(b),this.closeSiblingSubmenus(b)}}},{key:'handleMouseoutMenubar',value:function handleMouseoutMenubar(a){if(!a.defaultPrevented){a.target;this.closeAllSubmenus()}}},{key:'updateCurrentMenuitem',value:function updateCurrentMenuitem(a){this._currentMenuitem.setAttribute('tabindex','-1'),this._currentMenuitem=a,this._currentMenuitem.setAttribute('tabindex','0')}},{key:'hasSubmenu',value:function hasSubmenu(a){var b=a.parentNode,c=b.querySelector('a + ul');return null!=c}},{key:'openSubmenu',value:function openSubmenu(a){var b=a.parentNode,c=b.querySelector('ul');null!=c&&(c.classList.remove('a11y-menubar-menu-closed'),c.classList.add('a11y-menubar-menu-open'),a.setAttribute('aria-expanded','true'))}},{key:'closeSubmenu',value:function closeSubmenu(a){var b=a.parentNode,c=b.querySelector('ul');null!=c&&(c.classList.remove('a11y-menubar-menu-open'),c.classList.add('a11y-menubar-menu-closed'),a.setAttribute('aria-expanded','false'))}},{key:'closeSiblingSubmenus',value:function closeSiblingSubmenus(a){for(var b=a.parentNode.parentNode,c=b.querySelectorAll('li > a[role=menuitem]'),d=[],e=0;e<c.length;e++)c[e]!==a&&d.push(c[e]);for(var f=0;f<d.length;f++)this.closeSubmenu(d[f])}},{key:'closeAllSubmenus',value:function closeAllSubmenus(){for(var a,b=this._navElem.querySelectorAll('ul.a11y-menubar-menu-open'),c=0;c<b.length;c++)a=b[c].parentNode.querySelector('a'),a.setAttribute('aria-expanded','false'),b[c].classList.remove('a11y-menubar-menu-open'),b[c].classList.add('a11y-menubar-menu-closed')}},{key:'normalizeKey',value:function normalizeKey(a){var b=null;switch(a){case'Tab':case 9:b=this._keyCode.TAB;break;case'Enter':case 13:b=this._keyCode.ENTER;break;case'Escape':case'Esc':case 13:b=this._keyCode.ESC;break;case' ':case 32:b=this._keyCode.SPACE;break;case'End':case 35:b=this._keyCode.END;case'Home':case 36:b=this._keyCode.HOME;break;case'ArrowLeft':case 37:b=this._keyCode.ARROW_LEFT;break;case'ArrowUp':case 38:b=this._keyCode.ARROW_UP;break;case'ArrowRight':case 39:b=this._keyCode.ARROW_RIGHT;break;case'ArrowDown':case 40:b=this._keyCode.ARROW_DOWN;}return b}}]),a}();window.addEventListener('load',function(){new a11yMenubar('main-nav',document,'Main Navigation',hoverintent)});
//# sourceMappingURL=main-menu.js.map
